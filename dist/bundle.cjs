"use strict";var _=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var o=(e,t,n)=>(_(e,t,"read from private field"),n?n.call(e):t.get(e)),a=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},i=(e,t,n,r)=>(_(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),g=(e,t,n,r)=>({set _(s){i(e,t,s,n)},get _(){return o(e,t,r)}});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const z="data:application/javascript;base64,c2VsZi5vbm1lc3NhZ2UgPSAoZSkgPT4gewogIGNvbnN0IHsgcGF5bG9hZCB9ID0gZS5kYXRhIHx8IHt9OwogIGNvbnN0IHsgZm4sIGFyZyB9ID0gcGF5bG9hZCB8fCB7fTsKCiAgY29uc3QgbXNnID0gKG0pID0+IG0gfHwgIk5vIEVyciBNc2chIjsKICBjb25zdCBlcnIgPSAoZSkgPT4gKHsKICAgIG1zZzogZSBpbnN0YW5jZW9mIEVycm9yID8gbXNnKGUubWVzc2FnZSkgOiBKU09OLnN0cmluZ2lmeShtc2coZSkpLAogIH0pOwoKICBQcm9taXNlLnJlc29sdmUoYHJldHVybiAoJHtmbn0pKC4uLmFyZ3VtZW50cylgKQogICAgLnRoZW4oRnVuY3Rpb24pCiAgICAudGhlbigoZm4pID0+IGZuKC4uLmFyZykpCiAgICAudGhlbigKICAgICAgKHIpID0+IFtudWxsLCByXSwKICAgICAgKGUpID0+IFtlcnIoZSksIG51bGxdCiAgICApCiAgICAudGhlbihzZWxmLnBvc3RNZXNzYWdlKTsKfTsK",{freeze:A,create:Q}=Object;class C extends Array{}const G=e=>e instanceof C,K=e=>G(e)?e[0]?e:K():A(C.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),E=e=>G(e)?e:A(C.of(null,e)),k=e=>new Proxy(e,{async apply(...t){try{return E(await Reflect.apply(...t))}catch(n){return K(n)}}}),v=()=>{let e,t;const n=new Promise((r,s)=>{[e,t]=[r,s]});return{resolve:e,reject:t,pending:k(()=>n)()}},L=Symbol(),H=(e,t)=>{const n=[];let r=-1,s=-1;for(;++r<e.length;)n.push(e[r]===L?t[++s]:e[r]);for(;++s<t.length;)n.push(t[s]);return n},U=e=>t=>{const n=r=>new Proxy(t,{apply(s,c,b){const y=H(r,b).slice(0,e);return y.length===e&&!y.includes(L)?Reflect.apply(s,c,y):n(y)}});return n([])},D=U(2),S=e=>new Promise(t=>setTimeout(t,e));D((e,t)=>{let n=!0;const r=()=>{n=!1};return{loop:k(async()=>{for(n=!0,await S(e);n;)await t(),await S(e)}),stop:r}});const W=(...e)=>t=>{for(const n of e)t=n(t);return t},F=e=>{let t=null;return new Proxy(e,{async apply(...n){t==null&&(t=Promise.resolve(Reflect.apply(...n)));const r=await t;return t=null,r}})},T=W(F,k);class x{constructor(t){this.next=null,this.value=t}}var l,h,u;class O{constructor(){a(this,l,null);a(this,h,null);a(this,u,0)}size(){return o(this,u)}clear(){i(this,l,null),i(this,h,null),i(this,u,0)}shift(){const t=o(this,l);return o(this,u)&&(i(this,l,t.next),g(this,u)._--),o(this,u)||(i(this,l,null),i(this,h,null)),t==null?void 0:t.value}unshift(t){const n=new x(t);o(this,u)?(n.next=o(this,l),i(this,l,n)):(i(this,l,n),i(this,h,n)),g(this,u)._++}push(t){const n=new x(t);o(this,u)?(o(this,h).next=n,i(this,h,n)):(i(this,l,n),i(this,h,n)),g(this,u)._++}}l=new WeakMap,h=new WeakMap,u=new WeakMap;var I,d,p,m,w;class V{constructor(t){a(this,I,void 0);a(this,d,void 0);a(this,p,void 0);a(this,m,void 0);a(this,w,void 0);i(this,d,0),i(this,p,new O),this.add_task=r=>new Promise((s,c)=>{o(this,p).push({task:r,resolve:s,reject:c}),o(this,w).call(this)}),this.busy=()=>o(this,d)===o(this,I),this.clear=()=>{o(this,p).clear()},i(this,m,()=>!this.busy()&&o(this,p).size()>0),i(this,w,()=>{for(;o(this,m).call(this);){const{task:r,reject:s,resolve:c}=o(this,p).shift();g(this,d)._++,Promise.resolve().then(r).then(c).catch(s).finally(()=>{g(this,d)._--,o(this,w).call(this)})}});const{max_concurrency:n}=t||{};i(this,I,n)}}I=new WeakMap,d=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap;const N=()=>typeof Deno<"u"&&Deno.version!=null,P=()=>typeof process<"u"&&process.versions!=null,j=()=>typeof window<"u"&&window.document!=null,X=()=>{if(N()||j())return navigator.hardwareConcurrency;if(P())return require("os").cpus().length;throw new Error("Un Support Environment")},Y=()=>{if(N()||j()){const e=new URL(z,typeof document>"u"?require("url").pathToFileURL(__filename).href:document.currentScript&&document.currentScript.src||new URL("bundle.cjs",document.baseURI).href);return new Worker(e,{type:"module"})}if(P()){const e=new(require("worker_threads")).Worker(require("path").resolve(__dirname,"./_worker_node.js"));return e.addEventListener=(t,n)=>{e.on(t,n)},e}throw new Error("Un Support Environment")},q=()=>{const e=Y(),t={defer:v()};return e.addEventListener("message",r=>{const[s,c]=r.data||[];s!=null?t.defer.reject(s.msg):t.defer.resolve(c),t.defer=v()}),{worker:e,run:T(async(r,s)=>{e.postMessage({payload:{fn:r.toString(),arg:s}});const[c,b]=await t.defer.pending;if(c)throw c;return b})}};function J(e){const{max:t=X()-1}=e||{},n=new V({max_concurrency:t}),r=new Map,s=[],c=()=>{for(;r.size<t;){const{size:f}=r;r.set(f,q()),s.push(f)}};return{exec:(f,B)=>(c(),n.add_task(async()=>{const Z=s.pop(),R=await r.get(Z).run(f,B);return s.push(Z),R})),terminate:()=>{for(const{worker:f}of r.values())f.terminate();r.clear(),s.length=0,n.clear()}}}exports.worker_pool=J;
